{
  "name": "ai-proofreader",
  "displayName": "AI Proofreader",
  "description": "AI powered proofreading tools",
  "version": "1.1.2",
  "engines": {
    "vscode": "^1.85.0",
    "node": ">=18.12.1"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [],
  "main": "./dist/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "ai-proofread.managePrompts",
        "title": "AI Proofreader: set prompts"
      },
      {
        "command": "ai-proofread.selectPrompt",
        "title": "AI Proofreader: select prompt"
      },
      {
        "command": "ai-proofread.splitFileByLength",
        "title": "AI Proofreader: split by length"
      },
      {
        "command": "ai-proofread.splitFileByTitle",
        "title": "AI Proofreader: split by title"
      },
      {
        "command": "ai-proofread.splitFileWithTitleContext",
        "title": "AI Proofreader: split with title based context"
      },
      {
        "command": "ai-proofread.splitFileWithParagraphContext",
        "title": "AI Proofreader: split with paragraph based context"
      },
      {
        "command": "ai-proofread.splitFileByTitleAndLength",
        "title": "AI Proofreader: split by title and length"
      },
      {
        "command": "ai-proofread.mergeTwoFiles",
        "title": "AI Proofreader: merge two files"
      },
      {
        "command": "ai-proofread.proofreadFile",
        "title": "AI Proofreader: proofread file"
      },
      {
        "command": "ai-proofread.proofreadSelection",
        "title": "AI Proofreader: proofread selection"
      },
      {
        "command": "ai-proofread.diffItWithAnotherFile",
        "title": "AI Proofreader: diff it with another file"
      },
      {
        "command": "ai-proofread.searchSelectionInPDF",
        "title": "AI Proofreader: search selection in PDF"
      },
      {
        "command": "ai-proofread.convertDocxToMarkdown",
        "title": "AI Proofreader: convert docx to markdown"
      },
      {
        "command": "ai-proofread.convertPdfToMarkdown",
        "title": "AI Proofreader: convert PDF to markdown"
      },
      {
        "command": "ai-proofread.convertMarkdownToDocx",
        "title": "AI Proofreader: convert markdown to docx"
      },
      {
        "command": "ai-proofread.convertQuotes",
        "title": "AI Proofreader: convert quotes to Chinese"
      },
      {
        "command": "ai-proofread.formatParagraphs",
        "title": "AI Proofreader: format paragraphs"
      },
      {
        "command": "ai-proofread.splitFile",
        "title": "AI Proofreader: split file"
      },
      {
        "command": "ai-proofread.reopenResultPanel",
        "title": "AI Proofreader: reopen result panel"
      }
    ],
    "configuration": {
      "title": "AI Proofread",
      "properties": {
        "ai-proofread.proofread.platform": {
          "order": 10,
          "type": "string",
          "enum": [
            "deepseek",
            "aliyun",
            "google",
            "ollama"
          ],
          "enumDescriptions": [
            "Deepseek开放平台",
            "阿里云百炼平台",
            "Google Gemini平台",
            "Ollama本地模型"
          ],
          "default": "deepseek",
          "description": "大模型服务平台选择"
        },
        "ai-proofread.apiKeys.deepseek": {
          "order": 11,
          "type": "string",
          "default": "",
          "description": "Deepseek开放平台 API 密钥"
        },
        "ai-proofread.proofread.models.deepseek": {
          "order": 12,
          "type": "string",
          "default": "deepseek-chat",
          "description": "Deepseek开放平台模型,如: deepseek-chat（推理模型deepseek-reasoner容易失败且费用高）"
        },
        "ai-proofread.apiKeys.aliyun": {
          "order": 13,
          "type": "string",
          "default": "",
          "description": "阿里云百炼平台 API 密钥"
        },
        "ai-proofread.proofread.models.aliyun": {
          "order": 14,
          "type": "string",
          "default": "qwen-max-2025-01-25",
          "description": "阿里云百炼平台模型,如: qwen3-max-preview, qwen-max-latest,qwen-max,  qwen-plus-latest, qwen-plus, deepseek-v3, (推理模型deepseek-r1容易失败且费用高)"
        },
        "ai-proofread.apiKeys.google": {
          "order": 15,
          "type": "string",
          "default": "",
          "description": "Google Gemini API 密钥"
        },
        "ai-proofread.proofread.models.google": {
          "order": 16,
          "type": "string",
          "default": "gemini-2.5-pro-exp-03-25",
          "description": "Google Gemini 平台模型,如: gemini-2.5-pro, gemini-2.5-flash, gemini-2.5-flash-lite"
        },
        "ai-proofread.apiKeys.ollama": {
          "order": 18,
          "type": "string",
          "default": "http://localhost:11434",
          "description": "Ollama本地模型服务地址，如: http://localhost:11434"
        },
        "ai-proofread.proofread.models.ollama": {
          "order": 19,
          "type": "string",
          "default": "gemma3:1b",
          "description": "Ollama本地模型名称,如: gemma3:1b, gemma3:4b, llama3.2:1b, llama3.2:3b, mistral:7b; 推理模型：qwen3:0.6b, qwen3:1.7b, qwen3:4b, deepseek-r1:1.5b"
        },
        "ai-proofread.proofread.disableThinking": {
          "order": 20,
          "type": "boolean",
          "default": true,
          "description": "禁用模型思考功能（一般语言文字校对建议禁用，以提高速度，充分利用模型知识。目前仅适用于Gemini 2.5系列模型，且无法在 Gemini 2.5 Pro 上停用）"
        },
        "ai-proofread.proofread.retryAttempts": {
          "order": 21,
          "type": "number",
          "default": 3,
          "minimum": 1,
          "maximum": 10,
          "description": "API调用失败时的重试次数，默认3次"
        },
        "ai-proofread.proofread.retryDelay": {
          "order": 22,
          "type": "number",
          "default": 1,
          "minimum": 0.1,
          "maximum": 10,
          "description": "重试间隔时间（秒），默认1秒"
        },
        "ai-proofread.proofread.timeout": {
          "order": 23,
          "type": "number",
          "default": 90,
          "minimum": 5,
          "maximum": 300,
          "description": "API请求超时时间（秒），默认90秒"
        },
        "ai-proofread.proofread.rpm": {
          "order": 24,
          "type": "number",
          "default": 60,
          "description": "每分钟最大请求数，默认60。Deepseek无限制，但服务器在高流量时会延迟，请注意观察；阿里云百炼qwen-max系列稳定版的rpm通常为600甚至更高，带日期的快照版通常为60"
        },
        "ai-proofread.proofread.maxConcurrent": {
          "order": 25,
          "type": "number",
          "default": 10,
          "description": "最大并发请求数，默认10"
        },
        "ai-proofread.proofread.temperature": {
          "order": 26,
          "type": "number",
          "default": 1.0,
          "description": "模型温度，取值范围是[0:2)，留空则使用模型默认温度，默认1.0"
        },
        "ai-proofread.convertQuotes": {
          "order": 27,
          "type": "boolean",
          "default": false,
          "description": "是否在校对后自动将拉丁半角引号转换为中文全角引号"
        },
        "ai-proofread.defaultSplitLength": {
          "order": 28,
          "type": "number",
          "default": 600,
          "minimum": 50,
          "description": "默认的文本切分长度（字符数）"
        },
        "ai-proofread.defaultTitleLevels": {
          "order": 29,
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 1,
            "maximum": 6
          },
          "default": [
            2
          ],
          "description": "默认的标题切分级别（例如：[1,2] 表示按一级和二级标题切分）"
        },
        "ai-proofread.titleAndLengthSplit.threshold": {
          "order": 30,
          "type": "number",
          "default": 1000,
          "description": "标题加长度切分：段落长度阈值，超过此长度的段落将被切分"
        },
        "ai-proofread.titleAndLengthSplit.minLength": {
          "order": 31,
          "type": "number",
          "default": 120,
          "description": "标题加长度切分：最小长度，小于此长度的段落将被合并"
        },
        "ai-proofread.proofread.defaultContextLevel": {
          "order": 32,
          "type": "number",
          "default": 0,
          "description": "校对选中文本时，默认使用的标题级别作为上下文范围（0表示不使用）"
        },
        "ai-proofread.paragraphContextSplit.beforeParagraphs": {
          "order": 34,
          "type": "number",
          "default": 1,
          "description": "段落上下文切分模式：前文段落数"
        },
        "ai-proofread.paragraphContextSplit.afterParagraphs": {
          "order": 35,
          "type": "number",
          "default": 1,
          "description": "段落上下文切分模式：后文段落数"
        },
        "ai-proofread.prompts": {
          "order": 36,
          "type": "array",
          "default": [],
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "提示词名称"
              },
              "content": {
                "type": "string",
                "description": "提示词内容"
              }
            },
            "required": [
              "name",
              "content"
            ]
          },
          "description": "设置给大语言模型提示词及其名称。提示词中应对要处理的目标文本（target）、参考资料（reference）、上下文（context）进行说明。也可以通过命令管理"
        },
        "ai-proofread.alignment.windowSize": {
          "order": 37,
          "type": "number",
          "default": 10,
          "description": "句子对齐（生成勘误表）：搜索窗口大小（锚点左右各N个句子）"
        },
        "ai-proofread.alignment.similarityThreshold": {
          "order": 38,
          "type": "number",
          "default": 0.6,
          "description": "句子对齐（生成勘误表）：相似度阈值（0-1）"
        },
        "ai-proofread.alignment.ngramSize": {
          "order": 39,
          "type": "number",
          "default": 2,
          "description": "句子对齐（生成勘误表）：N-gram大小"
        },
        "ai-proofread.alignment.offset": {
          "order": 40,
          "type": "number",
          "default": 1,
          "description": "句子对齐（生成勘误表）：锚点偏移量"
        },
        "ai-proofread.alignment.maxWindowExpansion": {
          "order": 41,
          "type": "number",
          "default": 3,
          "description": "句子对齐（生成勘误表）：最大窗口扩展倍数"
        },
        "ai-proofread.alignment.consecutiveFailThreshold": {
          "order": 42,
          "type": "number",
          "default": 3,
          "description": "句子对齐（生成勘误表）：连续失败阈值"
        }
      }
    },
    "menus": {
      "editor/context": [
        {
          "command": "ai-proofread.proofreadSelection",
          "group": "ai-proofread@11",
          "when": "editorHasSelection && (resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex)"
        },
        {
          "command": "ai-proofread.searchSelectionInPDF",
          "group": "ai-proofread@12",
          "when": "editorHasSelection && (resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex)"
        },
        {
          "command": "ai-proofread.convertQuotes",
          "group": "ai-proofread@13",
          "when": "resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex"

        },
        {
          "command": "ai-proofread.formatParagraphs",
          "group": "ai-proofread@13",
          "when": "resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex"
        },
        {
          "command": "ai-proofread.diffItWithAnotherFile",
          "group": "ai-proofread@14",
          "when": "resourceLangId == json || resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex"
        },
        {
          "command": "ai-proofread.splitFile",
          "group": "ai-proofread@20",
          "when": "resourceLangId == markdown || resourceLangId == text || resourceLangId == context || resourceLangId == tex || resourceLangId == latex"
        },
        {
          "command": "ai-proofread.convertMarkdownToDocx",
          "group": "ai-proofread@21",
          "when": "resourceLangId == markdown"
        },
        {
          "command": "ai-proofread.proofreadFile",
          "group": "ai-proofread@31",
          "when": "resourceLangId == json"
        },
        {
          "command": "ai-proofread.mergeTwoFiles",
          "group": "ai-proofread@32",
          "when": "resourceLangId == json"
        }
      ]
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run package",
    "compile": "parcel build src/extension.ts --no-source-maps",
    "watch": "parcel watch src/extension.ts --no-source-maps",
    "package": "parcel build src/extension.ts --no-source-maps --no-cache",
    "lint": "eslint src --ext ts",
    "package-vsix": "npx vsce package",
    "publish": "npx vsce publish"
  },
  "dependencies": {
    "@google/genai": "^0.7.0",
    "axios": "^1.8.4",
    "dotenv": "^16.4.7"
  },
  "devDependencies": {
    "@eslint/config-array": "^0.19.2",
    "@eslint/object-schema": "^2.1.6",
    "@types/node": "^18.x",
    "@types/vscode": "^1.85.0",
    "@typescript-eslint/eslint-plugin": "^6.15.0",
    "@typescript-eslint/parser": "^6.15.0",
    "@vscode/vsce": "^3.3.2",
    "eslint": "^8.57.0",
    "glob": "^10.3.10",
    "parcel": "^2.11.0",
    "rimraf": "^5.0.5",
    "typescript": "^5.3.3"
  },
  "targets": {
    "main": {
      "context": "node",
      "includeNodeModules": {
        "vscode": false
      },
      "sourceMap": false,
      "outputFormat": "commonjs"
    }
  },
  "icon": "icon.png",
  "publisher": "HuangFusyong",
  "repository": {
    "type": "git",
    "url": "https://github.com/Fusyong/ai-proofread-vscode-extension.git"
  }
}
